序列化和反序列化
<div>

\
<div style="font-size: 16px">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:13px;line-height:1.35;color:rgb(0, 0, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="word-wrap:break-word;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">构造
[DataContractSerializer](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx)
的实例是一个重要步骤。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">完成构造后，将不能够更改任何设置。</span></span>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">指定根类型</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">根类型是序列化或反序列化实例的类型。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">
[DataContractSerializer](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx)
有许多构造函数重载，但必须使用 *type*
参数提供至少一个根类型。</span></span>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">为某个根类型创建的序列化程序不能用于序列化（或反序列化）其他类型，除非该类型是从根类型派生的。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">下面的示例演示了两个类。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-1)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
[DataContract]
public class Person
{
    // Code not shown.
}

[DataContract]
public class PurchaseOrder
{
    // Code not shown.
}
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">此代码构造
**DataContractSerializer** 的一个实例，它仅可用于序列化或反序列化 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Person</span>
类的实例。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-2)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
DataContractSerializer dcs = new DataContractSerializer(typeof(Person));
//This can now be used to serialize/deserialize Person but not PurchaseOrder.
```

</div>

</div>

</div>

</div>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-1 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">指定已知类型</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果在进行序列化的类型中涉及多态性并且尚未使用
[KnownTypeAttribute](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.knowntypeattribute(v=vs.110).aspx)
属性或一些其他机制进行处理，则必须使用 *knownTypes*
参数将可能的已知类型的列表传递给序列化程序的构造函数。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有关以下内容的详细信息已知类型的更多信息，请参见[数据协定已知类型](https://msdn.microsoft.com/zh-cn/library/ms730167(v=vs.110).aspx)。</span></span>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">下面的示例演示
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">LibraryPatron</span>
类，该类包含特定类型 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">LibraryItem</span>
的集合。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">第二个类定义
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">LibraryItem</span>
类型。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">第三个和第四个类（<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Book</span>
和 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Newspaper</span>）从
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">LibraryItem</span>
类继承。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-3)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
[DataContract]
public class LibraryPatron
{
    [DataMember]
    public LibraryItem[] borrowedItems;
}
[DataContract]
public class LibraryItem
{
    //code not shown
}

[DataContract]
public class Book : LibraryItem
{
    //code not shown
}

[DataContract]
public class Newspaper : LibraryItem
{
    //code not shown
}
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">下面的代码构造一个使用
*knownTypes* 参数的序列化程序的实例。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-4)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
//Create a serializer for the inherited types using the knownType parameter.
Type[] knownTypes = new Type[] { typeof(Book), typeof(Newspaper) };
DataContractSerializer dcs =
new DataContractSerializer(typeof(LibraryPatron), knownTypes);
// All types are known after construction.
```

</div>

</div>

</div>

</div>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-2 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">指定默认根名称和命名空间</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">通常，在对对象进行序列化时，将根据数据协定名称和命名空间确定最外面的
XML 元素的默认名称和命名空间。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">所有内部元素的名称将根据数据成员名称来确定，这些元素的命名空间是数据协定的命名空间。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">下面的示例设置
[DataContractAttribute](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.datacontractattribute(v=vs.110).aspx)
和
[DataMemberAttribute](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.datamemberattribute(v=vs.110).aspx)
类的构造函数中的 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Name</span>
和 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Namespace</span>
值。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-5)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
[DataContract(Name = "PersonContract", Namespace = "http://schemas.contoso.com")]
public class Person2
{
    [DataMember(Name = "AddressMember")]
    public Address theAddress;
}

[DataContract(Name = "AddressContract", Namespace = "http://schemas.contoso.com")]
public class Address
{
    [DataMember(Name = "StreetMember")]
    public string street;
}
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">对
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Person</span>
类的实例进行序列化将生成类似如下的 XML。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
<PersonContract xmlns="http://schemas.contoso.com">
  <AddressMember>
    <StreetMember>123 Main Street</StreetMember>
   </AddressMember>
</PersonContract>
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">但是，可以通过将
*rootName* 和 *rootNamespace* 参数的值传递到
[DataContractSerializer](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.datacontractserializer(v=vs.110).aspx)
构造函数，自定义根元素的默认名称和命名空间。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">注意，*rootNamespace*
不会影响对应于数据成员的所包含元素的命名空间，</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">而只是影响最外面元素的命名空间。</span></span>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">可以作为字符串或
[XmlDictionaryString](https://msdn.microsoft.com/zh-cn/library/system.xml.xmldictionarystring(v=vs.110).aspx)
类的实例来传递这些值，从而允许使用二进制 XML
格式对其进行优化。</span></span>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-3 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">设置最大对象配额</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">一些
**DataContractSerializer** 构造函数重载具有 *maxItemsInObjectGraph*
参数。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">此参数确定序列化程序在单个
[ReadObject](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.xmlobjectserializer.readobject(v=vs.110).aspx)
方法调用中序列化或反序列化的对象的最大数目。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">（该方法总是读取一个根对象，但此对象的数据成员中可以具有其他对象。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">这些对象又可以具有其他对象，依此类推。）默认值为
65536。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">请注意，当序列化或反序列化数组时，每个数组项都计为一个单独的对象。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">此外还应注意，一些对象可以有大内存表示形式，因此，单独使用此配额可能不足以防范拒绝服务攻击。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有关详细信息，请参见[数据的安全考虑事项](https://msdn.microsoft.com/zh-cn/library/ms733135(v=vs.110).aspx).</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果需要增加此配额以至超出默认值，则一定要在发送（序列化）和接收（反序列化）方同时增加此配额，原因是在读取和写入数据时会此配额同时应用于发送方和接收方。</span></span>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-4 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">往返行程</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">在一次操作中对对象进行反序列化和重新序列化时将发生往返行程。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">因此，往返行程是从
XML 到对象实例，然后再返回到 XML 流。</span></span>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">一些
**DataContractSerializer** 构造函数重载具有 *ignoreExtensionDataObject*
参数，该参数默认设置为 **false**。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">在此默认模式中，对于一个往返行程，可以将数据从数据协定的较新版本发送到较旧版本然后再返回到较新版本而不会出现任何损失，前提是数据协定实现
[IExtensibleDataObject](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.iextensibledataobject(v=vs.110).aspx)
接口。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">例如，假设
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Person</span>
数据协定的版本 1 包含 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Name</span>
和 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">PhoneNumber</span>
数据成员，并且版本 2 添加 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Nickname</span>
成员。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果在从版本
2 发送信息到版本 1 时实现 **，则存储 IExtensibleDataObject
数据，并在再次序列化数据时再次发出这些数据，因此在往返行程中不会出现数据丢失。**更多信息，请参见和<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Nickname</span>。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有关详细信息，请参见[向前兼容的数据协定](https://msdn.microsoft.com/zh-cn/library/ms731083(v=vs.110).aspx)
和
[数据协定版本管理](https://msdn.microsoft.com/zh-cn/library/ms731138(v=vs.110).aspx)。</span></span>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

####  {#section-5 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-top:20px;padding-bottom:5px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.077em;font-weight:normal;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">往返行程的安全性和架构有效性问题</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">往返行程可能会涉及到一些安全性问题。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">例如，反序列化和存储大量外来数据可能存在安全风险。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">重新发出无法验证的数据可能会存在安全问题，尤其是在涉及数字签名的情况下。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">例如，在前面的方案中，版本
1 终结点可能会对包含恶意数据的 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Nickname</span>
值进行签名。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">最后，还可能存在架构有效性问题：终结点可能需要始终发出严格符合其声明的协定并且没有任何额外值的数据。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">在前面的示例中，版本
1 终结点的协定声明该终结点仅发出 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Name</span>
和 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">PhoneNumber</span>，并且如果正在使用构造验证，则发出额外的
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">Nickname</span>
值将导致验证失败。</span></span>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

####  {#section-6 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-top:20px;padding-bottom:5px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.077em;font-weight:normal;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">启用和禁用往返行程</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">要关闭往返行程，请不要实现
[IExtensibleDataObject](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.iextensibledataobject(v=vs.110).aspx)
接口。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果您无法控制相应的类型，则将
*ignoreExtensionDataObject* 参数设置为 **true**
也可获得同样的效果。</span></span>

</div>

</div>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-7 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">对象图保留</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">通常，序列化程序并不关心对象标识，如在下面的代码中所示。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-7)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
[DataContract]
public class PurchaseOrder
{
    [DataMember]
    public Address billTo;
    [DataMember]
    public Address shipTo;
}

[DataContract]
public class Address
{
    [DataMember]
    public string street;
}
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">下面的代码创建一份订单。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div dir="ltr"
style="border-right-style:solid;border-top-left-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(112, 112, 112);border-top-style:solid;border-top-width:1px;border-top-color:rgb(147, 147, 147);font-size:13px;border-right-width:1px;border-right-color:rgb(147, 147, 147);border-bottom-style:solid;border-bottom-width:1px;border-bottom-color:rgb(255, 255, 255);border-left-color:rgb(147, 147, 147);background-color:transparent;border-left-width:1px;border-left-style:solid;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[C\#]()

</div>

<div dir="ltr"
style="border-top-style:solid;border-top-right-radius:4px;line-height:17px;height:22px;float:left;width:auto;padding:0px 15px;vertical-align:baseline;color:rgb(42, 42, 42);font-size:13px;border-top-width:1px;border-top-color:rgb(147, 147, 147);border-right-style:solid;border-right-width:1px;border-right-color:rgb(147, 147, 147);background-color:transparent;font-style:normal;font-family:'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[VB](https://msdn.microsoft.com/zh-cn/library/ms731073(v=vs.110).aspx?cs-save-lang=1&cs-lang=vb#code-snippet-8)

</div>

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
//Construct a purchase order:
Address adr = new Address();
adr.street = "123 Main St.";
PurchaseOrder po = new PurchaseOrder();
po.billTo = adr;
po.shipTo = adr;
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">请注意，将
<span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">billTo</span>
和 <span
style="color:rgb(0, 100, 0);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">shipTo</span>
字段设置为同一个对象实例。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">但是，生成的
XML 会复制重复的信息，并与下面的 XML 类似。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
<PurchaseOrder>
  <billTo><street>123 Main St.</street></billTo>
  <shipTo><street>123 Main St.</street></shipTo>
</PurchaseOrder>
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">不过，此方法具有以下可能不需要的特征：</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">性能。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">复制数据的效率低。</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">循环引用。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果对象引用自身，甚至通过其他对象引用自身，则通过复制进行序列化会导致无限循环。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">（如果发生这种状况，序列化程序将引发
    [SerializationException](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.serializationexception(v=vs.110).aspx)。）</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">语义。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有时，一定要记住这一点：两个引用指向的是同一个对象而不是两个相同的对象。</span></span>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有关这些原因，一些
**DataContractSerializer** 构造函数重载具有 *preserveObjectReferences*
参数（默认值为 **false**）。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">在将此参数设置为
**true** 时，将使用只有 WCF
才可以理解的编码引用的特殊方法。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">当设置为
**true** 时，XML 代码示例现在如下所示。</span></span>

<div
style="min-width:0px;clear:both;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="vertical-align:middle;height:23px;position:relative;z-index:1;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

<div
style="border:1px solid rgb(147, 147, 147);clear:both;margin-bottom:12px;position:relative;top:-1px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="width:auto;height:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="float:right;top:-8px;position:relative;width:auto;padding-left:0px;padding-right:0px;height:0px;vertical-align:top;background-color:rgb(255, 255, 255);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div dir="ltr"
style="width:auto;margin:0px;padding:10px 21px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="padding:0px;margin:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;color:Black;">

``` {style="padding:5px;margin:0px;font-style:normal;font-weight:normal;overflow:auto;word-wrap:normal;font-family:Consolas, Courier, monospace;"}
<PurchaseOrder ser:id="1">
  <billTo ser:id="2"><street ser:id="3">123 Main St.</street></billTo>
  <shipTo ser:ref="2"/>
</PurchaseOrder>
```

</div>

</div>

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">“ser”命名空间引用标准序列化命名空间
http://schemas.microsoft.com/2003/10/Serialization/。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">每一段数据只进行一次序列化并获得一个
ID 号，后续使用会导致引用已序列化的数据。</span></span>

<div
style="margin-bottom:10px;background-color:rgb(252, 254, 197);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="overflow-x:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

+--------------------------------------------------------------------------+
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"></span> |
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">重要事项 |
|                                                                          |
| </span>                                                                  |
+==========================================================================+
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span   |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">如果“id”和 |
| “ref”属性同时存在于数据协定                                              |
| **XMLElement** 中，则接受“ref”属性，而忽略“id”属性。</span></span>       |
+--------------------------------------------------------------------------+

</div>

</div>

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">了解此模式的限制是很重要的：</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">
    **DataContractSerializer** 在 *preserveObjectReferences* 设置为
    **true** 的情况下生成的 XML
    与任何其他技术都无法进行交互，仅可以由另一个其
    *preserveObjectReferences* 也设置为 **true** 的
    **DataContractSerializer** 实例进行访问。</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">元数据（架构）不支持此功能。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">生成的架构仅对
    *preserveObjectReferences* 设置为 **false**
    的情况有效。</span></span>

-   <span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">此功能可能导致序列化和反序列化进程运行速度减慢。</span></span><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
    style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">尽管不必复制数据，但是在此模式中必须执行额外的对象比较。</span></span>

<div
style="margin-bottom:10px;background-color:rgb(252, 254, 197);font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="overflow-x:auto;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

+--------------------------------------------------------------------------+
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"></span> |
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">小心</spa |
| n>                                                                       |
+==========================================================================+
| <span                                                                    |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span   |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">当启用  |
| *preserveObjectReferences* 模式时，需要将 *maxItemsInObjectGraph*        |
| 值设置为正确的配额，这一点特别重要。</span></span><span                  |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span   |
| style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Seg |
| oe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">由于在此模式中 |
| 处理数组的方式方面的原因，攻击者很容易构造一条小的恶意消息来造成内存大量消耗（仅通过 |
|                                                                          |
| *maxItemsInObjectGraph* 配额来限制）。</span></span>                     |
+--------------------------------------------------------------------------+

</div>

</div>

</div>

</div>

</div>

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

###  {#section-8 style="color:rgb(0, 0, 0);font-weight:normal;margin:0px;font-size:13px;padding-bottom:5px;padding-top:20px;font-family:'Segoe UI Semibold', 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;font-style:normal;"}

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

[<span
style="display:inline-block;color:rgb(0, 0, 0);font-size:1.231em;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">指定数据协定代理项</span>](# "折叠")
<div
style="padding-top:0px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

</div>

</div>

<div
style="padding-left:15px;display:block;padding-bottom:20px;font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<div
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">

<span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">一些
**DataContractSerializer** 构造函数重载具有 *dataContractSurrogate*
参数，该参数可以设置为 **null**。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">此外，可以使用它来指定数据协定代理项，数据协定代理项是一种实现
[IDataContractSurrogate](https://msdn.microsoft.com/zh-cn/library/system.runtime.serialization.idatacontractsurrogate(v=vs.110).aspx)
接口的类型。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">然后可以使用该接口来自定义序列化和反序列化进程。</span></span><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;"><span
style="font-family:'Microsoft YaHei UI', 'Microsoft YaHei', SimSun, 'Segoe UI', 'Lucida Grande', Verdana, Arial, Helvetica, sans-serif;">有关详细信息，请参见[数据协定代理项](https://msdn.microsoft.com/zh-cn/library/ms733064(v=vs.110).aspx).</span></span>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

</div>

\

</div>
