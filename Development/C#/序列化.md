序列化
<div>

<div>

using System;

</div>

<div>

using System.IO;

</div>

<div>

using System.IO.IsolatedStorage;

</div>

<div>

using System.Runtime.Serialization.Formatters.Binary;

</div>

<div>

using System.Xml.Serialization;

</div>

<div>

namespace DelftTools.Utils.Xml.Serialization

</div>

<div>

{

</div>

<div>

    /// &lt;summary&gt;

</div>

<div>

    /// Serialization format types.&lt;para /&gt;

</div>

<div>

    /// For serialization of an object to an XML Document file.&lt;para
/&gt;

</div>

<div>

    /// For serialization of an object to an XML Binary file.&lt;para
/&gt;

</div>

<div>

    /// For reading/writing data to an XML file.&lt;para /&gt;

</div>

<div>

    /// For accessing user isolated data.

</div>

<div>

    /// &lt;/summary&gt;

</div>

<div>

    public enum SerializedFormat

</div>

<div>

    {

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Binary serialization format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        Binary,

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Document serialization format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        Document

</div>

<div>

    }

</div>

<div>

    /// &lt;summary&gt;

</div>

<div>

    /// Facade to XML serialization and deserialization of strongly
typed objects to/from an XML file.

</div>

<div>

    /// &lt;seealso href="http://samples.gotdotnet.com/"&gt;References:
XML Serialization.&lt;/seealso&gt;&lt;para /&gt;

</div>

<div>

    /// &lt;seealso
cref="http://samples.gotdotnet.com/QuickStart/howto/default.aspx?url=/quickstart/howto/doc/xmlserialization/rwobjfromxml.aspx"/&gt;

</div>

<div>

   /// &lt;/summary&gt;

</div>

<div>

    public static class ObjectXmlSerializer&lt;T&gt; where T : class //
Specify that T must be a class.

</div>

<div>

    {

</div>

<div>

        \#region Load methods

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file in Document format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load(@"C:\\XMLObjects.xml");

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file in Document
format.&lt;/returns&gt;

</div>

<div>

        public static T Load(string path)

</div>

<div>

        {

</div>

<div>

            T serializableObject = LoadFromDocumentFormat(null, path,
null);

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file using a specified
serialized format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load(@"C:\\XMLObjects.xml",
SerializedFormat.Binary);

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;       

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="serializedFormat"&gt;XML serialized format
used to load the object.&lt;/param&gt;

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file using the
specified serialized format.&lt;/returns&gt;

</div>

<div>

        public static T Load(string path, SerializedFormat
serializedFormat)

</div>

<div>

        {

</div>

<div>

            T serializableObject;

</div>

<div>

            switch (serializedFormat)

</div>

<div>

            {

</div>

<div>

                case SerializedFormat.Binary:

</div>

<div>

                    serializableObject = LoadFromBinaryFormat(path,
null);

</div>

<div>

                    break;

</div>

<div>

                case SerializedFormat.Document:

</div>

<div>

                default:

</div>

<div>

                    serializableObject = LoadFromDocumentFormat(null,
path, null);

</div>

<div>

                    break;

</div>

<div>

            }

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file in Document format,
supplying extra data types to enable deserialization of custom types
within the object.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load(@"C:\\XMLObjects.xml",
new Type\[\] { typeof(MyCustomType) });

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="extraTypes"&gt;Extra data types to enable
deserialization of custom types within the object.&lt;/param&gt;

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file in Document
format.&lt;/returns&gt;

</div>

<div>

        public static T Load(string path, Type\[\] extraTypes)

</div>

<div>

        {

</div>

<div>

            T serializableObject = LoadFromDocumentFormat(extraTypes,
path, null);

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file in Document format, located
in a specified isolated storage area.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load("XMLObjects.xml",
IsolatedStorageFile.GetUserStoreForAssembly());

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to load the object from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file in Document
format located in a specified isolated storage area.&lt;/returns&gt;

</div>

<div>

        public static T Load(string fileName, IsolatedStorageFile
isolatedStorageDirectory)

</div>

<div>

        {

</div>

<div>

            T serializableObject = LoadFromDocumentFormat(null,
fileName, isolatedStorageDirectory);

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file located in a specified
isolated storage area, using a specified serialized format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load("XMLObjects.xml",
IsolatedStorageFile.GetUserStoreForAssembly(), SerializedFormat.Binary);

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;       

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to load the object from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="serializedFormat"&gt;XML serialized format
used to load the object.&lt;/param&gt;       

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file located in a
specified isolated storage area, using a specified serialized
format.&lt;/returns&gt;

</div>

<div>

        public static T Load(string fileName, IsolatedStorageFile
isolatedStorageDirectory,

</div>

<div>

                             SerializedFormat serializedFormat)

</div>

<div>

        {

</div>

<div>

            T serializableObject;

</div>

<div>

            switch (serializedFormat)

</div>

<div>

            {

</div>

<div>

                case SerializedFormat.Binary:

</div>

<div>

                    serializableObject = LoadFromBinaryFormat(fileName,
isolatedStorageDirectory);

</div>

<div>

                    break;

</div>

<div>

                case SerializedFormat.Document:

</div>

<div>

                default:

</div>

<div>

                    serializableObject = LoadFromDocumentFormat(null,
fileName, isolatedStorageDirectory);

</div>

<div>

                    break;

</div>

<div>

            }

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Loads an object from an XML file in Document format, located
in a specified isolated storage area, and supplying extra data types to
enable deserialization of custom types within the object.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// serializableObject =
ObjectXmlSerializer&lt;SerializableObject&gt;.Load("XMLObjects.xml",
IsolatedStorageFile.GetUserStoreForAssembly(), new Type\[\] {
typeof(MyCustomType) });

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;       

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to load the object from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to load the object
from.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="extraTypes"&gt;Extra data types to enable
deserialization of custom types within the object.&lt;/param&gt;

</div>

<div>

        /// &lt;returns&gt;Object loaded from an XML file located in a
specified isolated storage area, using a specified serialized
format.&lt;/returns&gt;

</div>

<div>

        public static T Load(string fileName, IsolatedStorageFile
isolatedStorageDirectory, Type\[\] extraTypes)

</div>

<div>

        {

</div>

<div>

            T serializableObject = LoadFromDocumentFormat(null,
fileName, isolatedStorageDirectory);

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        \#endregion

</div>

<div>

        \#region Save methods

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file in Document format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;       

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
@"C:\\XMLObjects.xml");

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to save the object
to.&lt;/param&gt;

</div>

<div>

        public static void Save(T serializableObject, string path)

</div>

<div>

        {

</div>

<div>

            SaveToDocumentFormat(serializableObject, null, path, null);

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file using a specified serialized
format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
@"C:\\XMLObjects.xml", SerializedFormat.Binary);

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to save the object
to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="serializedFormat"&gt;XML serialized format
used to save the object.&lt;/param&gt;

</div>

<div>

        public static void Save(T serializableObject, string path,
SerializedFormat serializedFormat)

</div>

<div>

        {

</div>

<div>

            switch (serializedFormat)

</div>

<div>

            {

</div>

<div>

                case SerializedFormat.Binary:

</div>

<div>

                    SaveToBinaryFormat(serializableObject, path, null);

</div>

<div>

                    break;

</div>

<div>

                case SerializedFormat.Document:

</div>

<div>

                default:

</div>

<div>

                    SaveToDocumentFormat(serializableObject, null, path,
null);

</div>

<div>

                    break;

</div>

<div>

            }

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file in Document format, supplying
extra data types to enable serialization of custom types within the
object.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;       

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
@"C:\\XMLObjects.xml", new Type\[\] { typeof(MyCustomType) });

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="path"&gt;Path of the file to save the object
to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="extraTypes"&gt;Extra data types to enable
serialization of custom types within the object.&lt;/param&gt;

</div>

<div>

        public static void Save(T serializableObject, string path,
Type\[\] extraTypes)

</div>

<div>

        {

</div>

<div>

            SaveToDocumentFormat(serializableObject, extraTypes, path,
null);

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file in Document format, located
in a specified isolated storage area.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;       

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
"XMLObjects.xml", IsolatedStorageFile.GetUserStoreForAssembly());

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to save the object to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to save the object
to.&lt;/param&gt;

</div>

<div>

        public static void Save(T serializableObject, string fileName,
IsolatedStorageFile isolatedStorageDirectory)

</div>

<div>

        {

</div>

<div>

            SaveToDocumentFormat(serializableObject, null, fileName,
isolatedStorageDirectory);

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file located in a specified
isolated storage area, using a specified serialized format.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;       

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
"XMLObjects.xml", IsolatedStorageFile.GetUserStoreForAssembly(),
SerializedFormat.Binary);

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to save the object to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to save the object
to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="serializedFormat"&gt;XML serialized format
used to save the object.&lt;/param&gt;       

</div>

<div>

        public static void Save(T serializableObject, string fileName,
IsolatedStorageFile isolatedStorageDirectory,

</div>

<div>

                                SerializedFormat serializedFormat)

</div>

<div>

        {

</div>

<div>

            switch (serializedFormat)

</div>

<div>

            {

</div>

<div>

                case SerializedFormat.Binary:

</div>

<div>

                    SaveToBinaryFormat(serializableObject, fileName,
isolatedStorageDirectory);

</div>

<div>

                    break;

</div>

<div>

                case SerializedFormat.Document:

</div>

<div>

                default:

</div>

<div>

                    SaveToDocumentFormat(serializableObject, null,
fileName, isolatedStorageDirectory);

</div>

<div>

                    break;

</div>

<div>

            }

</div>

<div>

        }

</div>

<div>

        /// &lt;summary&gt;

</div>

<div>

        /// Saves an object to an XML file in Document format, located
in a specified isolated storage area, and supplying extra data types to
enable serialization of custom types within the object.

</div>

<div>

        /// &lt;/summary&gt;

</div>

<div>

        /// &lt;example&gt;

</div>

<div>

        /// &lt;code&gt;

</div>

<div>

        /// SerializableObject serializableObject = new
SerializableObject();

</div>

<div>

        ///

</div>

<div>

        ///
ObjectXmlSerializer&lt;SerializableObject&gt;.Save(serializableObject,
"XMLObjects.xml", IsolatedStorageFile.GetUserStoreForAssembly(), new
Type\[\] { typeof(MyCustomType) });

</div>

<div>

        /// &lt;/code&gt;

</div>

<div>

        /// &lt;/example&gt;       

</div>

<div>

        /// &lt;param name="serializableObject"&gt;Serializable object
to be saved to file.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="fileName"&gt;Name of the file in the
isolated storage area to save the object to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="isolatedStorageDirectory"&gt;Isolated
storage area directory containing the XML file to save the object
to.&lt;/param&gt;

</div>

<div>

        /// &lt;param name="extraTypes"&gt;Extra data types to enable
serialization of custom types within the object.&lt;/param&gt;

</div>

<div>

        public static void Save(T serializableObject, string fileName,
IsolatedStorageFile isolatedStorageDirectory,

</div>

<div>

                                Type\[\] extraTypes)

</div>

<div>

        {

</div>

<div>

            SaveToDocumentFormat(serializableObject, null, fileName,
isolatedStorageDirectory);

</div>

<div>

        }

</div>

<div>

        \#endregion

</div>

<div>

        \#region Private

</div>

<div>

        private static FileStream CreateFileStream(IsolatedStorageFile
isolatedStorageFolder, string path)

</div>

<div>

        {

</div>

<div>

            FileStream fileStream;

</div>

<div>

            if (isolatedStorageFolder == null)

</div>

<div>

                fileStream = new FileStream(path,
FileMode.OpenOrCreate);

</div>

<div>

            else

</div>

<div>

                fileStream = new IsolatedStorageFileStream(path,
FileMode.OpenOrCreate, isolatedStorageFolder);

</div>

<div>

            return fileStream;

</div>

<div>

        }

</div>

<div>

        private static T LoadFromBinaryFormat(string path,
IsolatedStorageFile isolatedStorageFolder)

</div>

<div>

        {

</div>

<div>

            T serializableObject;

</div>

<div>

            using (FileStream fileStream =
CreateFileStream(isolatedStorageFolder, path))

</div>

<div>

            {

</div>

<div>

                BinaryFormatter binaryFormatter = new BinaryFormatter();

</div>

<div>

                serializableObject =
binaryFormatter.Deserialize(fileStream) as T;

</div>

<div>

            }

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        private static T LoadFromDocumentFormat(Type\[\] extraTypes,
string path,

</div>

<div>

                                                IsolatedStorageFile
isolatedStorageFolder)

</div>

<div>

        {

</div>

<div>

            T serializableObject;

</div>

<div>

            using (TextReader textReader =
CreateTextReader(isolatedStorageFolder, path))

</div>

<div>

            {

</div>

<div>

                XmlSerializer xmlSerializer =
CreateXmlSerializer(extraTypes);

</div>

<div>

                serializableObject =
xmlSerializer.Deserialize(textReader) as T;

</div>

<div>

            }

</div>

<div>

            return serializableObject;

</div>

<div>

        }

</div>

<div>

        private static TextReader CreateTextReader(IsolatedStorageFile
isolatedStorageFolder, string path)

</div>

<div>

        {

</div>

<div>

            TextReader textReader;

</div>

<div>

            if (isolatedStorageFolder == null)

</div>

<div>

                textReader = new StreamReader(path);

</div>

<div>

            else

</div>

<div>

                textReader = new StreamReader(new
IsolatedStorageFileStream(path, FileMode.Open, isolatedStorageFolder));

</div>

<div>

            return textReader;

</div>

<div>

        }

</div>

<div>

        private static TextWriter CreateTextWriter(IsolatedStorageFile
isolatedStorageFolder, string path)

</div>

<div>

        {

</div>

<div>

            TextWriter textWriter;

</div>

<div>

            if (isolatedStorageFolder == null)

</div>

<div>

            {

</div>

<div>

                textWriter = new StreamWriter(path);

</div>

<div>

            }

</div>

<div>

            else

</div>

<div>

            {

</div>

<div>

                textWriter =

</div>

<div>

                    new StreamWriter(new IsolatedStorageFileStream(path,
FileMode.OpenOrCreate, isolatedStorageFolder));

</div>

<div>

            }

</div>

<div>

            return textWriter;

</div>

<div>

        }

</div>

<div>

        private static XmlSerializer CreateXmlSerializer(Type\[\]
extraTypes)

</div>

<div>

        {

</div>

<div>

            Type ObjectType = typeof (T);

</div>

<div>

            XmlSerializer xmlSerializer;

</div>

<div>

            if (extraTypes != null)

</div>

<div>

                xmlSerializer = new XmlSerializer(ObjectType,
extraTypes);

</div>

<div>

            else

</div>

<div>

                xmlSerializer = new XmlSerializer(ObjectType);

</div>

<div>

            return xmlSerializer;

</div>

<div>

        }

</div>

<div>

        private static void SaveToDocumentFormat(T serializableObject,
Type\[\] extraTypes, string path,

</div>

<div>

                                                 IsolatedStorageFile
isolatedStorageFolder)

</div>

<div>

        {

</div>

<div>

            using (TextWriter textWriter =
CreateTextWriter(isolatedStorageFolder, path))

</div>

<div>

            {

</div>

<div>

                XmlSerializer xmlSerializer =
CreateXmlSerializer(extraTypes);

</div>

<div>

                XmlSerializerNamespaces ns = new
XmlSerializerNamespaces();

</div>

<div>

                ns.Add("", "");

</div>

<div>

                xmlSerializer.Serialize(textWriter, serializableObject,
ns);

</div>

<div>

            }

</div>

<div>

        }

</div>

<div>

        private static void SaveToBinaryFormat(T serializableObject,
string path,

</div>

<div>

                                               IsolatedStorageFile
isolatedStorageFolder)

</div>

<div>

        {

</div>

<div>

            using (FileStream fileStream =
CreateFileStream(isolatedStorageFolder, path))

</div>

<div>

            {

</div>

<div>

                BinaryFormatter binaryFormatter = new BinaryFormatter();

</div>

<div>

                binaryFormatter.Serialize(fileStream,
serializableObject);

</div>

<div>

            }

</div>

<div>

        }

</div>

<div>

        \#endregion

</div>

<div>

    }

</div>

<div>

}

</div>

<div>

\

</div>

</div>
